#:import utils kivy.utils
#:import Factory kivy.factory.Factory

<SDRootWidget>:
  apps: []
  canvas:
    Color:
      rgba: .3, 0, 0, 1
    Rectangle:
      pos: self.pos
      size: self.size
  size_hint: 1, 1
  orientation: 'vertical'
  padding: 10
  size_hint: 1, 1
  UserSelect:
    id: users
    selected_user: None
    config: root.model
    size_hint: 1, None
    height: '100dp'
  Widget:
    size_hint_y: None
    height: 10
  Apps:
    id: apps
    app_manager: root.app_manager
    model: root.model
    selected_user: users.selected_user
    size_hint_y: 1
  Widget:
    size_hint_y: None
    height: 10
  Button:
    size_hint_y: None
    height: 40
    text: 'Apply'
    on_release: root.apply()

<UserSelect>:
  config: None
  BoxLayout:
    id: layout
    padding: 10
    canvas:
      Color:
        rgba: .3, .3, .4, 1
      Rectangle:
        pos: self.pos
        size: self.size
    orientation: 'vertical'
    size_hint_y: None
    Label:
      text: 'Select Steam Users for which to install Apps'

<Apps>:
  id: layout
  app_manager: None
  selected_user: None
  apps: []
  canvas:
    Color:
      rgba: 0, .3, 0, 1
    Rectangle:
      pos: self.pos
      size: self.size
  orientation: 'vertical'
  Label:
    text: 'Web Apps'
    size_hint_y: None
  ScrollView:
    do_scroll: False, True
    BoxLayout:
      id: apps_container
      orientation: 'vertical'
      size_hint_y: None
      height: sum([c.height for c in self.children])
  Button:
    size_hint_y: None
    text: 'Add'
    #disabled: root.selected_user is None
    height: 44
    on_release: root.show_new_app_dialog(self.disabled)

<SDApp>:
  is_enabled: False
  orientation: 'horizontal'
  size_hint_y: None
  height: 42
  padding: 4
  BoxLayout:
    width: 100
    orientation: 'horizontal'
    BoxLayout:
      orientation: 'vertical'
      Label:
        size_hint_x: None
        width: self.texture_size[0]
        height: 20
        text: root.app.name
      Widget:
        size_hint_y: None
        height: 2
      Label:
        size_hint_x: None
        height: 20
        padding_x: 6
        font_size: 12
        color: utils.get_color_from_hex('#999999')
        width: self.texture_size[0]
        text: root.app.url
    Widget:
  Button:
    id: toggle_for_user_button
    size_hint_x: None
    width: 60
    text: '' if root.selected_user is None else ('Disable' if root.is_enabled else 'Enable')
    disabled: root.selected_user is None
    on_release: root.dispatch('on_toggle_enabled')
  Button:
    id: remove_button
    size_hint_x: None
    width: 60
    text: 'Remove'
    on_release: root.dispatch('on_remove')


<NewAppDialog>:
  field_label_width: 200
  app_name: 'My App'
  app_url: 'https://youtube.com'
  app_show_address_bar: False
  title: 'New App'
  size_hint: 0.95, 0.95
  auto_dismiss: False
  BoxLayout:
    orientation: 'vertical'
    Widget:
      size_hint_y: None
      height: 10
    TextField:
      label: 'name'
      placeholder: root.app_name
      label_width: root.field_label_width
      value_change: root.set_name
    TextField:
      label: 'url'
      placeholder: root.app_url
      label_width: root.field_label_width
      value_change: root.set_url
    CheckBoxField:
      label: 'show address bar'
      default: root.app_show_address_bar
      label_width: root.field_label_width
      value_change: root.set_show_address_bar
    Widget:
      height: 40
    Button:
      size_hint_y: None
      text: 'Create'
      on_release: root.dismiss()
    Widget:

<TextField@BoxLayout>:
  label: 'label'
  placeholder: ''
  label_width: 100
  value_change: None
  size_hint_y: None
  height: 35
  orientation: 'horizontal'
  BoxLayout:
    size_hint_x: None
    width: root.label_width
    orientation: 'horizontal'
    Label:
      width: root.label_width
      size_hint_x: None
      size: self.texture_size
      text: root.label
      padding_x: 5
      halign: 'left'
    Widget:
      size_hint_x: 1
  TextInput:
    text: root.placeholder
    on_text: root.value_change is not None and root.value_change(self.text)

<CheckBoxField@BoxLayout>
  label: 'label'
  default: False
  label_width: 100
  value_change: None
  size_hint_y: None
  height: 35
  orientation: 'horizontal'
  BoxLayout:
    size_hint_x: None
    width: root.label_width
    orientation: 'horizontal'
    Label:
      size_hint_x: None
      size: self.texture_size
      text: root.label
      padding_x: 5
      halign: 'left'
    Widget:
      size_hint_x: 1
  CheckBox:
    value: root.default
    size_hint_x: None
    on_release: root.value_change is not None and root.value_change(self.value)
  Widget:
    size_hint_x: 1

<HLine>:
  id: hline
  size_hint_y: None
  height: 0
  canvas:
    Color:
      rgb: 1., 0., 0.
    Rectangle:
      pos: 0, hline.center_y
      size: hline.width, 2
